<?xml version="1.0" encoding="UTF-8"?>
<!--Logback can operate without xml configuration file-->
<!--In this case it will attempt to use Java's ServiceLoader to locate-->
<!--an implementor of the com.qos.logback.classic.spi.Configurator and-->
<!--configure itself to log output directly to the console-->

<!--debug - debug mode for Logback-->
<!--scan - reloading configuration while an application is running every [scanPeriod] times-->
<configuration debug="false" scan="true" scanPeriod="60 seconds"
               xmlns="http://ch.qos.logback/xml/ns/logback"
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xsi:schemaLocation="http://ch.qos.logback/xml/ns/logback https://raw.githubusercontent.com/enricopulatzo/logback-XSD/master/src/main/xsd/logback.xsd">
<!--declare a new variable, can be set with JVM arguments (-Dname=value )-->
    <property name="LOG_DIR" value="./logs"/>

    <!--CONSOLE-->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%-5level [%thread] %date{dd MMMM yyyy HH:mm:ss} %logger Line:%line %message %n</pattern>
        </encoder>
    </appender>

    <!--TO FILE-->
    <appender name="TO_FILE" class="ch.qos.logback.core.FileAppender">
        <file>${LOG_DIR}/main.log</file>
        <!--append to an existing file rather than truncating it-->
        <append>true</append>
        <encoder>
            <pattern>%-5level %d{dd MMMM yyyy HH:mm:ss:zzz} %logger Line:%line %message %n</pattern>
        </encoder>
    </appender>

    <!--DAILY TO FILE-->
    <appender name="ROLLING_TO_FILE_DAILY" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${LOG_DIR}/daily_rolling_main.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <!-- defines the name of files and how often to roll them -->
            <!-- rolls over at the beginning of the day into -->
            <!-- ${LOG_DIR}/CurrentYear/CurrentMonth/CurrentDay.gz -->
            <!-- after the RollingFileAppender creates a new active file-->
            <fileNamePattern>${LOG_DIR}/archive/%d{yyyy/MMMM/dd}.gz</fileNamePattern>
            <!-- keep 30 days' worth of history capped at 3GB total size -->
            <maxHistory>30</maxHistory>
            <totalSizeCap>3GB</totalSizeCap>
        </rollingPolicy>
        <encoder>
            <pattern>%-5level %d{dd MMMM yyyy HH:mm:ss:zzz} %logger Line:%line %message %n</pattern>
        </encoder>
    </appender>

    <appender name="ROLLING_TO_FILE_SIZE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${LOG_DIR}/rolling_main_size.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">
            <fileNamePattern>${LOG_DIR}/by_size/%i.gz</fileNamePattern>
            <minIndex>1</minIndex>
            <maxIndex>3</maxIndex>
        </rollingPolicy>
        <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">
            <maxFileSize>1KB</maxFileSize>
        </triggeringPolicy>
        <encoder>
            <pattern>%-5level %d{dd MMMM yyyy HH:mm:ss:zzz} %logger Line:%line %message %n</pattern>
        </encoder>
    </appender>

    <!--set new logger for the package-->
    <!--additivity - turn off the default behavior (root?)-->
    <logger name="com.loggers" level="ERROR" additivity="false">
        <appender-ref ref="STDOUT"/>
    </logger>

    <!--root logger-->
    <root level="INFO">
        <appender-ref ref="STDOUT"/>
    </root>
</configuration>